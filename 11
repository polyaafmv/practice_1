import cv2
import numpy as np

# Загрузка изображения
image = cv2.imread("image.jpg")

if image is None:
    print("Ошибка: изображение не загружено. Проверь путь к файлу.")
    exit()

# Размытие
blurred = cv2.GaussianBlur(image, (11, 11), 0)

# Перевод в HSV
hsv = cv2.cvtColor(blurred, cv2.COLOR_BGR2HSV)

# Диапазон зелёного цвета (при необходимости подстрой)
green_min = np.array([40, 70, 50], np.uint8)
green_max = np.array([80, 255, 255], np.uint8)

# Маска зелёных областей
green_mask = cv2.inRange(hsv, green_min, green_max)

# Контуры и иерархия
green_contours, green_hierarchy = cv2.findContours(
    green_mask.copy(), cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE
)

# Обработка контуров
if green_hierarchy is not None:
    for i, contour in enumerate(green_contours):
        if green_hierarchy[0][i][3] == -1:  # внешний контур
            # Минимальная окружность
            (x, y), radius = cv2.minEnclosingCircle(contour)
            center = (int(x), int(y))

            # Отметить центр красной точкой
            cv2.circle(image, center, 3, (0, 0, 255), -1)

# Показ результата
cv2.imshow("Result", image)
cv2.waitKey(0)
cv2.destroyAllWindows()
